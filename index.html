<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kiboga Hill Farm Uganda</title>
  <meta name="description" content="Kiboga Hill Farm Uganda – Goats, cattle, bananas & coffee, with climate-smart advisory." />
  <style>
    :root{ --ink:#1f2937; --muted:#556070; --brand:#10b981; --amber:#f59e0b; --orange:#fb923c; --card:#ffffff; --shadow:0 10px 25px rgba(0,0,0,.08); --r:18px }
    *{box-sizing:border-box}
    body{margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji"}
    .container{max-width:1140px;margin:auto;padding:0 16px}
    header.khf-header{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.75);backdrop-filter:saturate(1.2) blur(8px);border-bottom:1px solid #eee}
    .row{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;font-size:18px;text-decoration:none;color:var(--ink)}
    .logo{width:38px;height:38px;border-radius:14px;display:grid;place-items:center;background:linear-gradient(135deg,#84cc16,#10b981);color:#fff;box-shadow:var(--shadow);font-weight:900}
    nav.khf-nav a{margin:0 10px;text-decoration:none;color:var(--ink);font-weight:700}
    nav.khf-nav a:hover{color:var(--brand)}
    .btn{display:inline-flex;align-items:center;gap:8px;border:0;padding:10px 16px;border-radius:16px;background:var(--brand);color:#fff;cursor:pointer;box-shadow:var(--shadow);text-decoration:none;font-weight:800}
    .btn.out{background:#fff;color:var(--ink);border:2px solid #e9ecef}
    section{padding:56px 0}
    h1,h2,h3{color:#2f7d32;margin:0 0 8px}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:16px}
    .cards{grid-template-columns:repeat(1,minmax(0,1fr))}
    .card{background:var(--card);border-radius:var(--r);box-shadow:var(--shadow);padding:18px}

    /* -------- Hero (fixed alignment) -------- */
    .hero{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:48px;
      flex-wrap:wrap;
      min-height:90vh;
      padding:80px 5%;
      background:linear-gradient(to bottom,#fff8ef,#f6f8e7);
      overflow:hidden;
    }
    .hero-text{ flex:1 1 460px; max-width:560px; }
    .hero-text h1{ font-size:2.8rem; line-height:1.2; color:var(--ink); font-weight:700; }
    .hero-text h1 span{ color:var(--brand); }
    .hero-text p{ font-size:1.05rem; color:var(--muted); margin-top:16px; line-height:1.6; }
    .hero-buttons{ display:flex; flex-wrap:wrap; gap:12px; margin-top:24px; }
    .hero-buttons .btn{ padding:12px 22px; border-radius:var(--r); font-weight:600; }
    .hero-image{ flex:1 1 460px; display:flex; justify-content:center; align-items:center; }
    .hero-frame{
  width:min(560px,100%);
  aspect-ratio:4/3;
  background:#fff;
  /* remove inner gap so the picture touches the frame */
  padding:0;
  border-radius:18px;
  box-shadow:var(--shadow);
  overflow:hidden;
  /* bring back a subtle motion */
  animation: floaty 8s ease-in-out infinite;
}
.hero-frame img{
  width:100%;
  height:100%;
  /* fill the box (may crop a little) */
  object-fit:contain;
  display:block;
}
    @media (max-width:900px){ .hero{ padding:56px 5%; gap:28px; } }

    /* --- Light float for small accents (optional) --- */
    @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(6px)}}

    /* --- Gallery + blur-up --- */
    .gallery-grid{display:flex;flex-wrap:wrap;gap:16px;justify-content:center;align-items:stretch}
    .gallery-tile{flex:0 1 260px;display:flex;flex-direction:column;padding:0;text-align:center;overflow:hidden;cursor:zoom-in}
    .gallery-tile img{width:100%;height:200px;object-fit:cover;object-position:center;display:block;filter:blur(12px);transform:scale(1.02);transition:filter .35s ease, transform .35s ease}
    .gallery-tile img.img-loaded{filter:none;transform:none}
    .gallery-caption{padding:10px 12px;font-size:14px;line-height:1.35;color:var(--ink);text-align:center;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;min-height:40px}
    @media (max-width: 720px){.gallery-tile{flex-basis:200px}.gallery-tile img{height:160px}}

    .banner{background:linear-gradient(90deg,#10b981,#84cc16,#f59e0b);color:#fff;border-radius:var(--r);box-shadow:var(--shadow);padding:22px}
    .split{display:grid;grid-template-columns:1fr;gap:18px}
    footer{border-top:1px solid #eee;padding:24px 0;color:var(--muted);font-size:14px;margin-top:8px}
    .icon{width:36px;height:36px;border-radius:12px;display:grid;place-items:center;background:#ecfeff}
    @media(min-width:760px){.cards{grid-template-columns:repeat(2,minmax(0,1fr))}}
    @media(min-width:1024px){.cards{grid-template-columns:repeat(4,minmax(0,1fr))}}
    .khf-root{ min-height:100vh; background: linear-gradient(180deg,#FFF7E6,#FFF0D6,#F0FFE3); color: var(--ink); }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React (UMD) + Babel for in-browser JSX -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useEffect, useMemo, useState } = React;

    /* ---------------- Data ---------------- */
    const PRODUCTS = [
      { slug: "goats", icon: "🐐", title: "Goats", desc: "Savanna, Galla, Boer & local Mubende lines for meat and resilience.", details: [
        "Breeding: structured cross-breeding for growth & hardiness",
        "Feeding: pasture-led; banana/coffee residues for circular nutrients",
        "Health: vaccination & deworming calendar; humane handling",
        "Sales: live weight pricing; farm-gate pick-up"
      ]},
      { slug: "cattle", icon: "🐄", title: "Cattle", desc: "Hardy breeds managed under humane, pasture-led systems.", details: [
        "Breeds: Ankole, Friesian crosses depending on system",
        "Grazing: rotational paddocks; water & shade planning",
        "Dairy & Beef: weaner calves, heifers, and steers",
        "Records: simple books for births, weights, treatments"
      ]},
      { slug: "bananas", icon: "🍌", title: "Bananas", desc: "Matooke blocks integrated with goats for nutrient recycling.", details: [
        "Spacing & mulching for moisture retention",
        "Manure use: composted goat bedding",
        "Pest/Disease: early detection & sanitation",
        "Market: bunch grading & handling"
      ]},
      { slug: "coffee", icon: "☕", title: "Coffee", desc: "Robusta & Arabica seedlings and farm-gate green beans.", details: [
        "Seedlings: vigorous varieties; shade integration",
        "Weed & canopy management",
        "Harvest: selective picking for quality",
        "Post-harvest: drying guidelines and storage"
      ]}
    ];

    const SERVICES = [
      { slug: "sales", icon: "🏪", title: "Farm-Gate Sales", text: "Goats, calves, eggs, coffee, and seasonal produce.", details: [
        "Order by WhatsApp; pickup windows shared weekly",
        "Bulk discounts for groups/Family members",
        "Quality assurance and humane standards"
      ]},
      { slug: "training", icon: "🚜", title: "Training camps & Farm Tours", text: "Hands-on sessions for youth and community groups, camps where goat bbq, mountain hiking and camp fire a must.", details: [
        "Half-day and full-day modules",
        "Housing design demos; record-keeping; bio-security",
        "Group rates for schools and SACCOs"
      ]},
      { slug: "climate", icon: "🌞", title: "Climate Services", text: "Actionable advisories for crop production including irrigation schedule, Livestock disease risk management", details: [
        "Weekly tips from seasonal & short-term forecasts",
        "Onset/cessation signals; heat-stress alerts",
        "Field-ready bulletins in simple language"
      ]}
    ];

    /* ---------------- Maps helpers ---------------- */
    const MAP = {
      label: "Kiboga Hill Farm Uganda",
      address: "3Km from Kikuubo, Bukomero Town Council off Hoima Road, Kyomya Sub county Kiboga District, Uganda",
      lat: 0.716167, // 0°42'58.2"N
      lng: 32.0245,  // 32°01'28.2"E
    };
    const mapsSearchUrl = () => `https://www.google.com/maps/search/?api=1&query=${MAP.lat},${MAP.lng}`;
    const mapsDirectionsUrl = () => `https://www.google.com/maps/dir/?api=1&destination=${MAP.lat},${MAP.lng}`;
    const mapsEmbedSrc = (type = 'satellite') => {
      const t = type === 'satellite' ? 'k' : (type === 'hybrid' ? 'h' : 'm'); // k=sat, h=hybrid, m=map
      return `https://maps.google.com/maps?q=${MAP.lat},${MAP.lng}&z=15&t=${t}&output=embed`;
    };

    /* ---------------- Tiny hash router ---------------- */
    function useHashRoute(){
      const [hash, setHash] = useState(() => window.location.hash || "#/");
      useEffect(() => {
        const onChange = () => setHash(window.location.hash || "#/");
        window.addEventListener("hashchange", onChange);
        return () => window.removeEventListener("hashchange", onChange);
      }, []);
      const parts = useMemo(() => hash.replace(/^#/, "").split("/").filter(Boolean), [hash]);
      return { parts };
    }

    const Link = ({ to, className = "", children, ...rest }) => (
      <a href={to} className={className} {...rest}>{children}</a>
    );

    const NotFound = ({ what = "Page" }) => (
      <section className="page" id="not-found">
        <div className="container">
          <h2>{what} Not Found</h2>
          <p className="muted">Sorry, the {what.toLowerCase()} you’re looking for doesn’t exist.</p>
          <Link className="btn out" to="#/">← Back Home</Link>
        </div>
      </section>
    );

    /* ---------------- Home (fixed hero) ---------------- */
    const Home = () => (
      <section className="hero">
        <div className="hero-text">
          <h1>
            Fresh.<br />
            Resilient.<br />
            <span>Ugandan</span> Farming.
          </h1>
          <p>
            We rear, buy and sell healthy and best breeds of goats, sheep, cattle, and chickens.
            We also grow, buy and sell coffee, bananas, maize, and trees — we are powered by farming
            passion and driven by science. We also utilise weather and climate forecasts for better
            yields and livestock production.
          </p>

          <div className="hero-buttons">
            <a href="#/about" className="btn" style={{ background: "var(--brand)", color: "white" }}>
              Explore Our Farm
            </a>
            <a href="#/family" className="btn" style={{ background: "white", color: "var(--ink)", boxShadow: "var(--shadow)" }}>
              Join as a Family Member — you will never regret
            </a>
          </div>
        </div>
<div className="hero-image">
  <div className="hero-frame">
    <img
      src="/Images/november-campfire-poster.png"
      alt="Kiboga Hill Farm November Campfire"
    />
  </div>

  {/* smooth scrolling “motion statement” */}
  <div className="ticker" aria-label="Upcoming camp details">
    <div className="ticker-track">
      <span className="ticker-bullet">•</span> 29–30 Nov 2025
      <span className="ticker-bullet">•</span> Goat BBQ / Goat Choma
      <span className="ticker-bullet">•</span> Practical Livestock & Crop Training
      <span className="ticker-bullet">•</span> Exciting Campfire
      <span className="ticker-bullet">•</span> Networking

      {/* duplicate the items once for a seamless loop */}
      <span className="ticker-bullet">•</span> 29–30 Nov 2025
      <span className="ticker-bullet">•</span> Goat BBQ / Goat Choma
      <span className="ticker-bullet">•</span> Practical Livestock & Crop Training
      <span className="ticker-bullet">•</span> Exciting Campfire
      <span className="ticker-bullet">•</span> Networking
    </div>
  </div>
</div>

      </section>
    );

    /* ---------------- Other Pages ---------------- */
    const About = () => (
      <section className="page" id="about">
        <div className="container">
          <h2>About Us</h2>
          <p className="muted">Kiboga Hill Farm Uganda blends modern agri-business with local wisdom. Led by a professional meteorologist, we integrate seasonal forecasts and on-farm observations to reduce risk, cut losses, and improve productivity—from breeding choices to harvest timing.</p>
        </div>
      </section>
    );

    const ProductsIndex = () => (
      <section className="page" id="products">
        <div className="container">
          <h2>Livestock & Crops</h2>
        <div className="grid cards">
          {PRODUCTS.map((item) => (
            <div key={item.slug} className="card">
              <div style={{display: "flex", gap: 10, alignItems: "center"}}>
                <div className="icon" aria-hidden>{item.icon}</div>
                <b>{item.title}</b>
              </div>
              <p className="muted" style={{marginTop: 8}}>{item.desc}</p>
              <div style={{marginTop: 8}}>
                <Link className="btn out" to={`#/products/${item.slug}`}>View details</Link>
              </div>
            </div>
          ))}
        </div>
        </div>
      </section>
    );

    const ProductDetail = ({ slug }) => {
      const p = PRODUCTS.find(x => x.slug === slug);
      if (!p) return <NotFound what="Product"/>;
      return (
        <section className="page" id={`product-${slug}`}>
          <div className="container">
            <div style={{display:"flex", justifyContent:"space-between", alignItems:"center", gap:12, flexWrap:"wrap"}}>
              <h2 style={{display:"flex", alignItems:"center", gap:10}}><span className="icon" aria-hidden>{p.icon}</span>{p.title}</h2>
              <Link className="btn out" to="#/products">← Back to Livestock & Crops</Link>
            </div>
            <p className="muted" style={{marginTop:8}}>{p.desc}</p>
            <ul className="muted" style={{margin: "12px 0 0 18px"}}>
              {p.details.map(d => <li key={d}>{d}</li>)}
            </ul>
          </div>
        </section>
      );
    };

    const ServicesIndex = () => (
      <section className="page" id="services">
        <div className="container">
          <h2>What We Offer</h2>
          <div className="grid cards" style={{gridTemplateColumns: "repeat(1,minmax(0,1fr))"}}>
            {SERVICES.map(s => (
              <div key={s.slug} className="card">
                <div style={{display: "flex", gap: 10, alignItems: "center"}}>
                  <div className="icon" aria-hidden>{s.icon}</div>
                  <b>{s.title}</b>
                </div>
                <p className="muted" style={{marginTop: 8}}>{s.text}</p>
                <div style={{marginTop: 8}}>
                  <Link className="btn out" to={`#/services/${s.slug}`}>View details</Link>
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>
    );

    const ServiceDetail = ({ slug }) => {
      const s = SERVICES.find(x => x.slug === slug);
      if (!s) return <NotFound what="Service"/>;
      return (
        <section className="page" id={`service-${slug}`}>
          <div className="container">
            <div style={{display:"flex", justifyContent:"space-between", alignItems:"center", gap:12, flexWrap:"wrap"}}>
              <h2 style={{display:"flex", alignItems:"center", gap:10}}><span className="icon" aria-hidden>{s.icon}</span>{s.title}</h2>
              <Link className="btn out" to="#/services">← Back to Services</Link>
            </div>
            <p className="muted" style={{marginTop:8}}>{s.text}</p>
            <ul className="muted" style={{margin: "12px 0 0 18px"}}>
              {s.details.map(d => <li key={d}>{d}</li>)}
            </ul>
          </div>
        </section>
      );
    };

    const Family = () => (
      <section className="page" id="family">
        <div className="container">
          <div className="banner">
            <h2 style={{margin: 0}}>Family Project</h2>
            <p style={{margin: ".3rem 0 0"}}><b>Goal: Kiboga Hill Farm Family Members</b> — Who contributes monthly towards a family enterprise which might be for goats, cows or chicken among others. This gives us market linkages and collective marketing power.</p>
          </div>
          <div className="grid cards" style={{marginTop: 16, gridTemplateColumns: "repeat(1,minmax(0,1fr))"}}>
            {[
              { title: "Starter Pack", pts: ["Breeding guidance", "Housing designs", "Health schedule"] },
              { title: "Climate Edge", pts: ["Seasonal outlooks", "Rain alerts", "Heat stress tips"] },
              { title: "Market Link", pts: ["Collective sales", "Quality standards", "Fair pricing"] },
            ].map((b) => (
              <div key={b.title} className="card">
                <b>{b.title}</b>
                <ul className="muted" style={{margin: "8px 0 0 16px"}}>
                  {b.pts.map(p => <li key={p}>{p}</li>)}
                </ul>
              </div>
            ))}
          </div>
          <div style={{marginTop: 12}}><Link className="btn" to="#/contact" aria-label="Apply to  Program">Apply Now →</Link></div>
        </div>
      </section>
    );

    const Advisory = () => (
      <section className="page" id="advisory">
        <div className="container">
          <h2>Weather-Smart Advisory</h2>
          <p className="muted">We translate forecasts into simple actions: when to plant, when to vaccinate, and how to manage heat and rainfall. Join our WhatsApp broadcast to get weekly tips.</p>
          <div className="grid cards" style={{gridTemplateColumns: "repeat(1,minmax(0,1fr))"}}>
            {[
              { title: "Planting Windows", text: "Use onset signals to time sowing for better germination." },
              { title: "Livestock Care", text: "Heat-stress alerts, water plans, and disease risk updates." },
              { title: "Harvest & Post-Harvest", text: "Dry spells for safe drying; rain risk for storage plans." },
            ].map((a) => (
              <div key={a.title} className="card">
                <b>{a.title}</b>
                <p className="muted" style={{marginTop: 8}}>{a.text}</p>
              </div>
            ))}
          </div>
        </div>
      </section>
    );

    const SocialCTA = () => (
      <section className="page" id="social">
        <div className="container split">
          <div>
            <h2>See the Farm in Action</h2>
            <p className="muted">Follow our daily stories, experiments, and tips.</p>
            <div style={{display: "flex", gap: 12, flexWrap: "wrap", marginTop: 10}}>
              <Link className="btn" to="https://wa.me/256763081880" target="_blank" rel="noopener noreferrer">WhatsApp</Link>
              <Link className="btn out" to="https://www.tiktok.com/@kiboga_hill_farm.ug" target="_blank" rel="noopener noreferrer">TikTok</Link>
              <Link className="btn out" to="https://www.instagram.com/kibogahillfarmuganda/" target="_blank" rel="noopener noreferrer">Instagram</Link>
              <Link className="btn out" to="https://www.youtube.com/@Kibogahillfarm.ug1" target="_blank" rel="noopener noreferrer">YouTube</Link>
              <Link className="btn out" to="https://web.facebook.com/profile.php?id=61581757133392" target="_blank" rel="noopener noreferrer">Facebook</Link>
            </div>
          </div>
          <div className="card">
            <p className="muted">“We believe farming can be profitable, climate-smart, and youth-friendly. Join us.”</p>
            <div style={{display: "flex", gap: 10, alignItems: "center", marginTop: 10}}>
              <div className="icon" aria-hidden>🏞️</div>
              <div><b>Kiboga Hill Farm Team</b><div className="muted" style={{fontSize: 14}}>Kiboga • Uganda</div></div>
            </div>
          </div>
        </div>
      </section>
    );

    /* -------- Email helpers (kept for later server wiring) -------- */
    const EMAIL_PRIMARY = "khf@kibogahillfarmuganda.co.ug";
    const MAIL_SUBJECT  = encodeURIComponent("Inquiry from Kiboga Hill Farm website");
    const MAIL_BODY     = encodeURIComponent("Hello Kiboga Hill Farm team,\n\nI’d like to ask about …\n\nThanks,");

    /* ---------------- Contact ---------------- */
    const Contact = () => {
      const [mapType, setMapType] = React.useState("satellite");
      return (
        <section className="page" id="contact">
          <div className="container">
            <h2>Contact</h2>

            <div className="grid cards" style={{ gridTemplateColumns: "repeat(1,minmax(0,1fr))" }}>
              <div className="card">
                <b>Phone & WhatsApp</b>
                <div className="muted">+256 (0) 703 663 616</div>
              </div>

              <div className="card">
                <b>Email</b>
                <p><a href="mailto:info@kibogahillfarmuganda.co.ug">info@kibogahillfarmuganda.co.ug</a></p>
                <a className="btn"
                   href={"mailto:info@kibogahillfarmuganda.co.ug?subject=Hello%20Kiboga%20Hill%20Farm&body=Hi%20KHF%20Team,%0A%0AMy%20name%20is%20____.%20I%27m%20interested%20in%20____.%0A%0ARegards,%0A____"}>
                  Talk to Us
                </a>
              </div>

              <div className="card">
                <b>Location</b>
                <div className="muted">{MAP.address}</div>
                <div style={{display:"flex",gap:10,flexWrap:"wrap",marginTop:10}}>
                  <a className="btn" href={mapsSearchUrl()} target="_blank" rel="noopener noreferrer">Open in Google Maps</a>
                  <a className="btn out" href={mapsDirectionsUrl()} target="_blank" rel="noopener noreferrer">Get Directions</a>
                </div>
              </div>

              <div className="card">
                <b>Social</b>
                <div style={{ display:"flex", gap:10, flexWrap:"wrap", marginTop:10 }}>
                  <a className="btn" href="https://wa.me/256703663616" target="_blank" rel="noopener noreferrer">WhatsApp</a>
                  <a className="btn out" href="https://www.tiktok.com/@kiboga_hill_farm.ug" target="_blank" rel="noopener noreferrer">TikTok</a>
                  <a className="btn out" href="https://www.instagram.com/kibogahillfarmuganda/" target="_blank" rel="noopener noreferrer">Instagram</a>
                  <a className="btn out" href="https://www.youtube.com/@Kibogahillfarm.ug1" target="_blank" rel="noopener noreferrer">YouTube</a>
                  <a className="btn out" href="https://web.facebook.com/profile.php?id=61581757133392" target="_blank" rel="noopener noreferrer">Facebook</a>
                </div>
              </div>
            </div>

            <div className="card" style={{ marginTop:16, padding:0, overflow:"hidden" }}>
              <div style={{ display:"flex", gap:8, justifyContent:"flex-end", padding:"10px 12px" }}>
                <button className={mapType==="roadmap" ? "btn" : "btn out"} onClick={()=>setMapType("roadmap")}>Map</button>
                <button className={mapType==="satellite" ? "btn" : "btn out"} onClick={()=>setMapType("satellite")}>Satellite</button>
                <button className={mapType==="hybrid" ? "btn" : "btn out"} onClick={()=>setMapType("hybrid")}>Hybrid</button>
              </div>

              <div style={{ position:"relative", width:"100%", paddingBottom:"56%" }}>
                <iframe title="Kiboga Hill Farm – Map"
                        src={mapsEmbedSrc(mapType)}
                        style={{ position:"absolute", inset:0, width:"100%", height:"100%", border:0 }}
                        loading="lazy"
                        referrerPolicy="no-referrer-when-downgrade"></iframe>
              </div>
              <div style={{ padding:12, fontSize:12, color:"#556070" }}>
                Pin set to exact GPS coordinates: {MAP.lat}, {MAP.lng}
              </div>
            </div>
          </div>
        </section>
      );
    };

    /* -------- Gallery (thumbs + blur-up) -------- */
    const Gallery = () => {
      const [items, setItems] = React.useState([]);
      const [error, setError] = React.useState("");
      const [lightbox, setLightbox] = React.useState(null);

      const thumbPath = (src, dpr2=false) => {
        const match = src.match(/^(.*?)(\.[^.]+)$/);
        const base = match ? match[1] : src;
        const w = dpr2 ? "1040" : "520";
        return `Images/thumbs/${base}-${w}.webp`;
      };

      React.useEffect(() => {
        (async () => {
          try {
            const res = await fetch("Images/manifest.json");
            if (!res.ok) throw new Error("manifest.json not found");
            const data = await res.json();
            const normalized = (Array.isArray(data) ? data : [])
              .map((x) => typeof x === "string" ? { src: x, caption: "" } :
                           (x && typeof x === "object" ? { src: x.src || "", caption: x.caption || "" } : null))
              .filter(Boolean).filter(x => x.src);
            setItems(normalized);
          } catch (e) {
            console.error(e);
            setError("Could not load Images/manifest.json. Ensure it exists and contains valid JSON.");
          }
        })();
      }, []);

      return (
        <section className="page" id="gallery">
          <div className="container">
            <h2>Farm Gallery</h2>
            {error && <div className="card" style={{color:"#9a3412", background:"#fff7ed"}}>{error}</div>}

            <div className="card" style={{padding:12}}>
              {items.length === 0 ? (
                <div className="muted">No images listed yet.</div>
              ) : (
                <div className="gallery-grid">
                  {items.map(({ src, caption }, i) => {
                    const thumb1x = thumbPath(src, false);
                    const thumb2x = thumbPath(src, true);
                    const full = `Images/${src}`;
                    return (
                      <figure key={i} className="card gallery-tile" style={{padding:0, margin:0}}>
                        <button onClick={() => setLightbox({ src: full, caption })}
                                aria-label={`Open ${caption || src}`}
                                style={{display:"block", padding:0, border:0, background:"transparent", cursor:"zoom-in"}}>
                          <img
                            src={thumb1x}
                            srcSet={`${thumb1x} 520w, ${thumb2x} 1040w`}
                            sizes="(max-width:720px) 200px, 260px"
                            alt={caption || src}
                            loading="lazy"
                            decoding="async"
                            onLoad={(e)=> e.currentTarget.classList.add("img-loaded")}
                            onError={(e)=> { e.currentTarget.src = full; e.currentTarget.removeAttribute('srcset'); }}
                          />
                        </button>
                        {caption ? <figcaption className="gallery-caption">{caption}</figcaption> : null}
                      </figure>
                    );
                  })}
                </div>
              )}
            </div>

            {lightbox && (
              <div className="lightbox" onClick={()=>setLightbox(null)} role="dialog" aria-label="Image preview">
                <div style={{textAlign:"center"}}>
                  <img src={lightbox.src} alt={lightbox.caption || "Preview"} />
                  {lightbox.caption ? <div className="lightbox-caption">{lightbox.caption}</div> : null}
                </div>
              </div>
            )}
          </div>
        </section>
      );
    };

    /* ---------------- App Shell ---------------- */
    function App(){
      const { parts } = useHashRoute();
      const route = (parts[0] || "").toLowerCase();
      const sub = (parts[1] || "").toLowerCase();

      useEffect(() => {
        const fails = [];
        const assert = (name, cond) => { if (cond) console.log("✅", name); else { console.error("❌", name); fails.push(name); } };
        assert("Nav exists", !!document.querySelector("nav.khf-nav"));
        assert("Router working (page rendered)", !!document.querySelector("section.page, section.hero"));
        if (fails.length === 0) console.log("🎉 All smoke tests passed."); else console.warn("ℹ️ Smoke tests failed:", fails);
      }, [route, sub]);

      return (
        <div className="khf-root">
          <header className="khf-header">
            <div className="container row">
              <Link to="#/" className="brand"><span className="logo">KH</span> Kiboga Hill Farm Uganda</Link>
              <nav className="khf-nav" aria-label="Primary">
                <Link to="#/about">About</Link>
                <Link to="#/products">Livestock & Crops</Link>
                <Link to="#/services">Services</Link>
                <Link to="#/family">Family</Link>
                <Link to="#/advisory">Advisory</Link>
                <Link to="#/gallery">Gallery</Link>
                <Link to="#/contact">Contact</Link>
              </nav>
            </div>
          </header>

          {(!route || route === "") && <Home/>}
          {(route === "about") && <About/>}
          {(route === "products" && !sub) && <ProductsIndex/>}
          {(route === "products" && sub) && <ProductDetail slug={sub}/>}
          {(route === "services" && !sub) && <ServicesIndex/>}
          {(route === "services" && sub) && <ServiceDetail slug={sub}/>}
          {(route === "family") && <Family/>}
          {(route === "advisory") && <Advisory/>}
          {(route === "gallery") && <Gallery/>}
          {(route === "contact") && <Contact/>}
          {(!["", "about", "products", "services", "family", "advisory", "gallery", "contact"].includes(route)) && <NotFound/>}

          <footer>
            <div className="container" style={{textAlign: "center"}}>
              © {new Date().getFullYear()} Kiboga Hill Farm Uganda. All rights reserved.
            </div>
          </footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>



